# API Gateway

API Gateway is a managed service from AWS that allows us to create and manage APIs.

It sits between our applications and other services.

API Gateway supports containerized and serverless workloads as well as web applications.

## Endpoint Types

- Edge-Optimized — Route to the nearest CloudFront Point-of-presence (POP).

* Regional — Clients in the same region.
* Private — Endpoint accessible only within a VPC via an interface endpoint.

## Stages

APIs are deployed to stages. Each stage has one deployment.

Stages can be enabled to utilize _canary deployments_. If enabled, deployments would then be made to the canary and not to the stage.

Stages enabled for canary deployments can also be configured so that a certain percentage of traffic is sent to the canary.

This amount can be adjusted over time, and the canary can even be promoted and become the new ‘base stage' in the future.

## Errors

Error codes generated by API Gateway generally fall into one of two categories:

- 4xx - Client Error — Invalid client-side request.
- 5xx - Server Error — Valid request, backend issue

Some specific error codes to remember are:

- 400 - Bad Request — Generic.
- 403 - Access Denied — Either request denied from the Authorizer or request filtered by something such as the web application firewall.
- 429 - Throttling — API Gateway’s configured throttle amount has been exceeded.
- 502 - Bad Gateway Exception — Bad output provided by the backend service.
- 503 - Service Unavailable — The backing endpoint is offline or there is some other major service issues.
- 504 — Integration Failure/Timeout - 29 second limit.
